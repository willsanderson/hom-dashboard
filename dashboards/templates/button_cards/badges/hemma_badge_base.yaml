# Base Badge Template
hemma_badge_base:
  styles:
    card:
      - background: var(--badge-background)
      - box-shadow: var(--badge-shadow)
      - backdrop-filter: blur(8px)
      - -webkit-backdrop-filter: blur(8px)
      - border-radius: var(--badge-br, 9999px)
      - padding: var(--badge-padding-current, var(--badge-padding, 6px 14px))
      - min-height: var(--badge-min-height-current, var(--badge-min-height, 44px))
      - display: >
          [[[
            // Robust enabled check - handles boolean, number, and string inputs
            const v = variables?.enabled;
            if (v === undefined || v === null) return 'inline-grid';
            if (typeof v === 'boolean') return v ? 'inline-grid' : 'none';
            if (typeof v === 'number') return v !== 0 ? 'inline-grid' : 'none';
            const s = String(v).trim().toLowerCase();
            if (['false','0','no','off','disabled'].includes(s)) return 'none';
            return 'inline-grid';
          ]]]
      - align-items: center
      - gap: var(--badge-col-gap-current, var(--badge-col-gap, 10px))
      - width: fit-content
      - margin-inline-start: 0
      - margin-inline-end: 0
      - margin-block-start: 0
      - margin-block-end: 0
      - position: relative
      - isolation: isolate
      - --badge-title-color: var(--primary-text-color)
      - --badge-sub-color: var(--secondary-text-color)
      - background-clip: padding-box
      - overflow: hidden

    grid:
      - grid-template-areas: '"i l"'
      - grid-template-columns: min-content minmax(0, 1fr)
      - column-gap: var(--badge-col-gap-current, var(--badge-col-gap, 10px))
      - row-gap: 0
      - align-items: center

    name:
      - grid-area: l
      - min-width: 0
      - color: var(--badge-title-color, var(--secondary-text-color))
      - font-weight: 700
      - font-size: var(--badge-font-size-current, var(--badge-font-size, 13px))
      - line-height: 1.2
      - text-align: left
      - justify-self: start
      - z-index: 4

    icon:
      - grid-area: i
      - width: var(--badge-icon-size-current, var(--badge-icon-size, 28px))
      - height: var(--badge-icon-size-current, var(--badge-icon-size, 28px))
      - color: var(--primary-text-color)
      - z-index: 4

    img_cell:
      - width: var(--badge-icon-size-current, var(--badge-icon-size, 30px)) !important
      - height: var(--badge-icon-size-current, var(--badge-icon-size, 30px)) !important
      - border-radius: 9999px !important
      - overflow: hidden !important
      - display: block !important

    entity_picture:
      - grid-area: i
      - width: var(--badge-icon-size-current, var(--badge-icon-size, 28px))
      - height: var(--badge-icon-size-current, var(--badge-icon-size, 28px))
      - border-radius: 50%
      - z-index: 4
      - object-fit: cover

    label:
      - font-size: var(--badge-font-size-current, var(--badge-font-size, 13px))

    state:
      - font-size: var(--badge-font-size-current, var(--badge-font-size, 13px))

  extra_styles: |
    :host{
      --media-sub-opacity: .82;
      --badge-after-z:  2;
      --badge-before-z: 3;
    }

    @media (max-width: 767px) and (orientation: portrait) {
      ha-card {
        min-height: 43px !important;
        padding: 1px 14px 1px 6px !important;
      }
      #img-cell, .img-cell {
        width: 32px !important;
        height: 32px !important;
      }
      #name {
        font-size: 13px !important;
      }
      .mp-title {
        font-size: 13px !important;
      }
      .mp-sub {
        font-size: 12px !important;
      }
    }

    @media (max-height: 600px) and (orientation: landscape) {
      ha-card {
        min-height: 36px !important;
        padding: 1px 12px 1px 6px !important;
      }
      #img-cell, .img-cell {
        width: 26px !important;
        height: 26px !important;
      }
      #name {
        font-size: 12px !important;
      }
      .mp-title {
        font-size: 12px !important;
      }
      .mp-sub {
        font-size: 11px !important;
      }
    }

    ha-card::after{  z-index: var(--badge-after-z, 2) !important; }
    ha-card::before{ z-index: var(--badge-before-z, 3) !important; }

    #img-cell{
      width:  var(--badge-icon-size-current, var(--badge-icon-size, 32px)) !important;
      height: var(--badge-icon-size-current, var(--badge-icon-size, 32px)) !important;
      border-radius: 9999px !important;
      overflow: hidden !important;
      display: block !important;
    }

    #img-cell img,
    #img-cell ha-img{
      width: 100% !important;
      height: 100% !important;
      object-fit: cover !important;
      display: block !important;
      border-radius: inherit !important;
    }

    #name{
      display:flex !important;
      align-items:center !important;
      padding-block: 2px !important;
      min-width: 0 !important;
      overflow: hidden !important;
      line-height: normal !important;
    }

    .mp-wrap{
      display:flex;
      flex-direction:column;
      align-items:flex-start;
      gap: 2px;
      min-width:0;
      max-width:100%;
      padding-top: 0 !important;
      padding-bottom: 2px !important;
    }

    .mp-title{
      font-size: var(--badge-font-size-current, 13px);
      font-weight: 700;
      line-height: 1.1;
      color: var(--badge-title-color, var(--secondary-text-color));
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .mp-sub{
      font-size: calc(var(--badge-font-size-current, 13px) - 1px);
      font-weight: 500;
      line-height: 1.05;
      opacity: var(--media-sub-opacity, .82);
      color: var(--badge-sub-color, var(--secondary-text-color));
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

